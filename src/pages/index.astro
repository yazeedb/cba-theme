---
import { isWithinInterval, addWeeks } from 'date-fns';
import Layout from '../layouts/Layout.astro';
import EventCard from '../components/EventCard.astro';
import NewTabLink from '../components/NewTabLink.astro';
import Section from '../components/Section.astro';
import YouTube from '../components/svgs/YouTube.astro';
import Facebook from '../components/svgs/Facebook.astro';
import Instagram from '../components/svgs/Instagram.astro';
import { Carousel } from '../components/Carousel';
import { getEvents } from '../data';

const events = await getEvents();
const upcomingEvents = events.filter((event) =>
  isWithinInterval(new Date(event.date), {
    start: new Date(),
    end: addWeeks(new Date(), 2)
  })
);
---

<Layout title="Home">
  <main>
    <Carousel client:load />

    <Section>
      <section class="flex justify-between items-center">
        <h2 class="text-primary-header-dark section-heading">
          Upcoming Events
        </h2>

        <a
          class="border-slate-700 text-slate-700 font-bold border-2 p-2 rounded flex items-center"
          href="/events"
        >
          <span class="px-2">View all</span>

          <svg
            width="24"
            height="21"
            viewBox="0 0 24 21"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M17.1859 12.6094H2.00069C1.47007 12.6094 0.961191 12.3987 0.585989 12.0236C0.210787 11.6485 0 11.1398 0 10.6094C0 10.079 0.210787 9.57025 0.585989 9.19518C0.961191 8.82011 1.47007 8.6094 2.00069 8.6094H17.1859L12.5843 4.0094C12.3763 3.82859 12.2079 3.60675 12.0896 3.3578C11.9714 3.10884 11.9059 2.83815 11.8972 2.56269C11.8886 2.28724 11.937 2.01297 12.0394 1.7571C12.1418 1.50123 12.296 1.26928 12.4923 1.07579C12.6886 0.882309 12.9228 0.731471 13.1802 0.632744C13.4376 0.534016 13.7126 0.489528 13.988 0.502073C14.2634 0.514618 14.5332 0.583924 14.7806 0.705643C15.0279 0.827361 15.2474 0.998866 15.4253 1.2094L23.4281 9.2094C23.7947 9.58325 24 10.0859 24 10.6094C24 11.1329 23.7947 11.6355 23.4281 12.0094L15.4253 20.0094C15.0449 20.34 14.5538 20.5148 14.05 20.499C13.5462 20.4832 13.067 20.2779 12.7081 19.9242C12.3492 19.5705 12.1371 19.0944 12.1141 18.591C12.0912 18.0877 12.2591 17.5943 12.5843 17.2094L17.1859 12.6094Z"
              fill="#334155"></path>
          </svg>
        </a>
      </section>

      <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {upcomingEvents.map((event) => <EventCard event={event} />)}
      </section>
    </Section>

    <Section containerClass="bg-primary-green text-paragraph-light">
      <h2 class="section-heading">Learn About the CBA</h2>

      <p class="section-paragraph">
        The Circassian Benevolent Association, nestled in the quaint town of
        Wayne, New Jersey, stands as a beacon of cultural heritage and community
        spirit. Established in the late 19th century by early Circassian
        immigrants, this association has been a cornerstone of support and
        cultural preservation for the Circassian community in America.
      </p>

      <a class="cta-button self-start" href="/about">Read more</a>
    </Section>

    <Section>
      <h2 class="section-heading">IG Feed Placeholder</h2>

      <p class="section-paragraph">
        The Instagram feed will go here. For now this is sample content to get a
        sense of what the final layout will look like on mobile, desktop, and
        other screen sizes.
      </p>
    </Section>

    <Section containerClass="bg-primary-green text-paragraph-light">
      <h2 class="section-heading">Circassian History</h2>

      <p class="section-paragraph">
        Circassians, also called Cherkess or Adyghe (Adyghe and Kabardian:
        Адыгэхэр, romanized: Adygekher), are an indigenous Northwest Caucasian
        ethnic group and nation native to the historical country-region of
        Circassia in the North Caucasus.
      </p>

      <p class="section-paragraph">
        As a consequence of the Circassian genocide perpetrated by the Russian
        Empire in the 19th century during the Russo-Circassian War, most
        Circassians were exiled from their homeland in Circassia to modern-day
        Turkey and the rest of the Middle East, where most of them are today.
      </p>

      <p class="section-paragraph">
        In the early 1990s, the Unrepresented Nations and Peoples Organization
        estimated that there are as many as 3.7 million Circassians in diaspora
        in over 50 countries.
      </p>

      <a class="cta-button self-start" href="/history">Learn more</a>
    </Section>

    <Section>
      <h2 class="section-heading">Connect With Us</h2>

      <p class="text-paragraph-dark">
        We are located at
        {
          /*
            The "-mr-1" class below only exists because Prettier's formatting forces
            an empty space between the CBA's address and punctuation mark.

            This is a little hack to force less spacing, I wish I didn't have to do it >:(
          */
        }
        <NewTabLink
          href="https://maps.google.com?q=Circassian Benevolent Association Wayne NJ"
          class="text-href-color -mr-1"
        >
          383 Oldham Road, Wayne, NJ 07470
        </NewTabLink>.
      </p>

      <p class="text-paragraph-dark">
        Our main office number is
        <a href="tel:+9737908979" class="text-href-color">(973) 790-8979</a>.
      </p>

      <p class="text-paragraph-dark">Check out our social media pages!</p>

      <div class="flex gap-base">
        <NewTabLink href="https://www.youtube.com/@cba_america">
          <YouTube class="w-12 h-auto" />
        </NewTabLink>

        <NewTabLink href="https://www.facebook.com/CBA.America/">
          <Facebook class="w-12 h-auto" />
        </NewTabLink>

        <NewTabLink href="https://www.instagram.com/cba_america/?hl=en">
          <Instagram class="w-12 h-auto" />
        </NewTabLink>
      </div>
    </Section>
  </main>
</Layout>
