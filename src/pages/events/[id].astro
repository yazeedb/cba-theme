---
import { getEvents } from '../../data';
import Layout from '../../layouts/Layout.astro';
import Section from '../../components/Section.astro';
import { format } from 'date-fns';

export async function getStaticPaths() {
  const events = await getEvents();

  return events.map((e) => ({ params: { id: e.id }, props: { events } }));
}

const { id } = Astro.params;
const { events } = Astro.props;

const event = events.find((e) => e.id === id)!;
---

<Layout title={event.title}>
  <main>
    <Section containerClass="mt-4 text-paragraph-dark">
      <header id="event-header">
        <a href="/events" class="flex items-center gap-1 text-href-color mb-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-4 h-4"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m18.75 4.5-7.5 7.5 7.5 7.5m-6-15L5.25 12l7.5 7.5"></path>
          </svg>

          All Events
        </a>

        <section class="flex gap-2 justify-between">
          <section>
            <h1 class="section-heading text-primary-header-dark">
              {event.title}
            </h1>

            <section
              id="time-and-date"
              class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2"
            >
              <span>
                {format(event.date, 'MMMM d, yyyy')}
              </span>

              <span class="hidden sm:block">|</span>

              <span>
                {event.startTime} - {event.endTime}
              </span>
            </section>
          </section>

          <a href="#" class="cta-button self-start">
            <span class="sm:hidden flex gap-1 items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="w-5 h-5"
              >
                <path
                  fill-rule="evenodd"
                  d="M6.75 2.25A.75.75 0 0 1 7.5 3v1.5h9V3A.75.75 0 0 1 18 3v1.5h.75a3 3 0 0 1 3 3v11.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V7.5a3 3 0 0 1 3-3H6V3a.75.75 0 0 1 .75-.75Zm13.5 9a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5Z"
                  clip-rule="evenodd"></path>
              </svg>

              <span>Add</span>
            </span>

            <span class="hidden sm:block">Add to Google Calendar</span>
          </a>
        </section>
      </header>

      <section id="event-body" class="flex flex-col gap-4">
        <img
          id="event-image"
          src={event.image}
          alt={`Main image for ${event.title}`}
          class="rounded"
        />

        <article
          id="event-details"
          class="section-paragraph text-paragraph-dark flex-1"
        >
          {event.description}
        </article>
      </section>
    </Section>
  </main>
</Layout>
